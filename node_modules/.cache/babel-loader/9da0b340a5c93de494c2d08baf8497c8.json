{"ast":null,"code":"/* eslint-disable no-undef */\nconst resolveURL = require('resolve-url');\n\nconst {\n  log\n} = require('../utils/log');\n/*\n * Fetch data from remote URL and convert to blob URL\n * to avoid CORS issue\n */\n\n\nconst toBlobURL = async (url, mimeType) => {\n  log('info', `fetch ${url}`);\n  const buf = await (await fetch(url)).arrayBuffer();\n  log('info', `${url} file size = ${buf.byteLength} bytes`);\n  const blob = new Blob([buf], {\n    type: mimeType\n  });\n  const blobURL = URL.createObjectURL(blob);\n  log('info', `${url} blob URL = ${blobURL}`);\n  return blobURL;\n};\n\nmodule.exports = async _ref => {\n  let {\n    corePath: _corePath\n  } = _ref;\n\n  if (typeof _corePath !== 'string') {\n    throw Error('corePath should be a string!');\n  }\n\n  const coreRemotePath = resolveURL(_corePath);\n  const corePath = await toBlobURL(coreRemotePath, 'application/javascript');\n  const wasmPath = await toBlobURL(coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.wasm'), 'application/wasm');\n  const workerPath = await toBlobURL(coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.worker.js'), 'application/javascript');\n\n  if (typeof createFFmpegCore === 'undefined') {\n    return new Promise(resolve => {\n      const script = document.createElement('script');\n\n      const eventHandler = () => {\n        script.removeEventListener('load', eventHandler);\n        log('info', 'ffmpeg-core.js script loaded');\n        resolve({\n          createFFmpegCore,\n          corePath,\n          wasmPath,\n          workerPath\n        });\n      };\n\n      script.src = corePath;\n      script.type = 'text/javascript';\n      script.addEventListener('load', eventHandler);\n      document.getElementsByTagName('head')[0].appendChild(script);\n    });\n  }\n\n  log('info', 'ffmpeg-core.js script is loaded already');\n  return Promise.resolve({\n    createFFmpegCore,\n    corePath,\n    wasmPath,\n    workerPath\n  });\n};","map":{"version":3,"names":["resolveURL","require","log","toBlobURL","url","mimeType","buf","fetch","arrayBuffer","byteLength","blob","Blob","type","blobURL","URL","createObjectURL","module","exports","corePath","_corePath","Error","coreRemotePath","wasmPath","replace","workerPath","createFFmpegCore","Promise","resolve","script","document","createElement","eventHandler","removeEventListener","src","addEventListener","getElementsByTagName","appendChild"],"sources":["/Users/ekaterinapavlova/PycharmProjects/onix/autoSea/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js"],"sourcesContent":["/* eslint-disable no-undef */\nconst resolveURL = require('resolve-url');\nconst { log } = require('../utils/log');\n\n/*\n * Fetch data from remote URL and convert to blob URL\n * to avoid CORS issue\n */\nconst toBlobURL = async (url, mimeType) => {\n  log('info', `fetch ${url}`);\n  const buf = await (await fetch(url)).arrayBuffer();\n  log('info', `${url} file size = ${buf.byteLength} bytes`);\n  const blob = new Blob([buf], { type: mimeType });\n  const blobURL = URL.createObjectURL(blob);\n  log('info', `${url} blob URL = ${blobURL}`);\n  return blobURL;\n};\n\nmodule.exports = async ({ corePath: _corePath }) => {\n  if (typeof _corePath !== 'string') {\n    throw Error('corePath should be a string!');\n  }\n  const coreRemotePath = resolveURL(_corePath);\n  const corePath = await toBlobURL(\n    coreRemotePath,\n    'application/javascript',\n  );\n  const wasmPath = await toBlobURL(\n    coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.wasm'),\n    'application/wasm',\n  );\n  const workerPath = await toBlobURL(\n    coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.worker.js'),\n    'application/javascript',\n  );\n  if (typeof createFFmpegCore === 'undefined') {\n    return new Promise((resolve) => {\n      const script = document.createElement('script');\n      const eventHandler = () => {\n        script.removeEventListener('load', eventHandler);\n        log('info', 'ffmpeg-core.js script loaded');\n        resolve({\n          createFFmpegCore,\n          corePath,\n          wasmPath,\n          workerPath,\n        });\n      };\n      script.src = corePath;\n      script.type = 'text/javascript';\n      script.addEventListener('load', eventHandler);\n      document.getElementsByTagName('head')[0].appendChild(script);\n    });\n  }\n  log('info', 'ffmpeg-core.js script is loaded already');\n  return Promise.resolve({\n    createFFmpegCore,\n    corePath,\n    wasmPath,\n    workerPath,\n  });\n};\n"],"mappings":"AAAA;AACA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AACA,MAAM;EAAEC;AAAF,IAAUD,OAAO,CAAC,cAAD,CAAvB;AAEA;AACA;AACA;AACA;;;AACA,MAAME,SAAS,GAAG,OAAOC,GAAP,EAAYC,QAAZ,KAAyB;EACzCH,GAAG,CAAC,MAAD,EAAU,SAAQE,GAAI,EAAtB,CAAH;EACA,MAAME,GAAG,GAAG,MAAM,CAAC,MAAMC,KAAK,CAACH,GAAD,CAAZ,EAAmBI,WAAnB,EAAlB;EACAN,GAAG,CAAC,MAAD,EAAU,GAAEE,GAAI,gBAAeE,GAAG,CAACG,UAAW,QAA9C,CAAH;EACA,MAAMC,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACL,GAAD,CAAT,EAAgB;IAAEM,IAAI,EAAEP;EAAR,CAAhB,CAAb;EACA,MAAMQ,OAAO,GAAGC,GAAG,CAACC,eAAJ,CAAoBL,IAApB,CAAhB;EACAR,GAAG,CAAC,MAAD,EAAU,GAAEE,GAAI,eAAcS,OAAQ,EAAtC,CAAH;EACA,OAAOA,OAAP;AACD,CARD;;AAUAG,MAAM,CAACC,OAAP,GAAiB,cAAmC;EAAA,IAA5B;IAAEC,QAAQ,EAAEC;EAAZ,CAA4B;;EAClD,IAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;IACjC,MAAMC,KAAK,CAAC,8BAAD,CAAX;EACD;;EACD,MAAMC,cAAc,GAAGrB,UAAU,CAACmB,SAAD,CAAjC;EACA,MAAMD,QAAQ,GAAG,MAAMf,SAAS,CAC9BkB,cAD8B,EAE9B,wBAF8B,CAAhC;EAIA,MAAMC,QAAQ,GAAG,MAAMnB,SAAS,CAC9BkB,cAAc,CAACE,OAAf,CAAuB,gBAAvB,EAAyC,kBAAzC,CAD8B,EAE9B,kBAF8B,CAAhC;EAIA,MAAMC,UAAU,GAAG,MAAMrB,SAAS,CAChCkB,cAAc,CAACE,OAAf,CAAuB,gBAAvB,EAAyC,uBAAzC,CADgC,EAEhC,wBAFgC,CAAlC;;EAIA,IAAI,OAAOE,gBAAP,KAA4B,WAAhC,EAA6C;IAC3C,OAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;MAC9B,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;;MACA,MAAMC,YAAY,GAAG,MAAM;QACzBH,MAAM,CAACI,mBAAP,CAA2B,MAA3B,EAAmCD,YAAnC;QACA7B,GAAG,CAAC,MAAD,EAAS,8BAAT,CAAH;QACAyB,OAAO,CAAC;UACNF,gBADM;UAENP,QAFM;UAGNI,QAHM;UAINE;QAJM,CAAD,CAAP;MAMD,CATD;;MAUAI,MAAM,CAACK,GAAP,GAAaf,QAAb;MACAU,MAAM,CAAChB,IAAP,GAAc,iBAAd;MACAgB,MAAM,CAACM,gBAAP,CAAwB,MAAxB,EAAgCH,YAAhC;MACAF,QAAQ,CAACM,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,WAAzC,CAAqDR,MAArD;IACD,CAhBM,CAAP;EAiBD;;EACD1B,GAAG,CAAC,MAAD,EAAS,yCAAT,CAAH;EACA,OAAOwB,OAAO,CAACC,OAAR,CAAgB;IACrBF,gBADqB;IAErBP,QAFqB;IAGrBI,QAHqB;IAIrBE;EAJqB,CAAhB,CAAP;AAMD,CA3CD"},"metadata":{},"sourceType":"script"}